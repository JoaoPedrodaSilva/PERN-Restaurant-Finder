{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Jo\\xE3o Pedro/Dropbox/VisualStudioCode/PortfolioWebsite/projects/PERN-Restaurant-Finder/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Jo\\xE3o Pedro/Dropbox/VisualStudioCode/PortfolioWebsite/projects/PERN-Restaurant-Finder/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useEffect,useCallback}from'react';import{Link}from'react-router-dom';import axios from'../apis/axios';import{useGlobalContext}from'../globalContext';import ReviewRatingStars from'./ReviewRatingStars';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RestaurantList=function RestaurantList(){var _useGlobalContext=useGlobalContext(),allRestaurants=_useGlobalContext.allRestaurants,setAllRestaurants=_useGlobalContext.setAllRestaurants;useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/');case 3:response=_context.sent;setAllRestaurants(response.data.restaurants);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[allRestaurants]);// The data fetching above has an infinite loop.\n// Tried to fix that with useCallback below, but did not work.\n// const fetchData = useCallback(async () => {\n//     console.log(allRestaurants)\n//         try {\n//             const response = await axios.get('/')\n//             setAllRestaurants(response.data.restaurants)\n//         } catch (error) {\n//             console.log(error)\n//         }\n//     }, [allRestaurants])\n//     useEffect(() => {\n//         fetchData()\n//     }, [allRestaurants, fetchData])        \nvar handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/\".concat(id));case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return function handleDelete(_x){return _ref2.apply(this,arguments);};}();var renderRating=function renderRating(restaurant){if(!restaurant.total_ratings){return/*#__PURE__*/_jsx(\"span\",{children:\"None\"});}else{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ReviewRatingStars,{rating:restaurant.average_rating}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-yellow-500\",children:[\"(\",restaurant.total_ratings,\")\"]})]});}};//rendering component\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full overflow-y-auto overflow-x-hidden\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full border-collapse border border-slate-400 text-xs text-center\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-blue-500 text-white break-words sticky top-0\",children:/*#__PURE__*/_jsxs(\"tr\",{className:\"h-8\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"border border-slate-300\",children:\"Restaurant\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-slate-300\",children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-slate-300\",children:\"Price Range\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-slate-300\",children:\"Ratings\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-slate-300\",children:\"Review\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-slate-300\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border border-slate-300\",children:\"Delete\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:allRestaurants&&allRestaurants.map(function(restaurant){return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-blue-100 h-12\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"border border-slate-300 break-all\",children:restaurant.name}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-slate-300 break-all\",children:restaurant.location}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-slate-300 break-all\",children:'$'.repeat(restaurant.price_range)}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-slate-300 break-all\",children:renderRating(restaurant)}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-slate-300\",children:/*#__PURE__*/_jsx(Link,{to:\"/restaurants/\".concat(restaurant.id),children:/*#__PURE__*/_jsx(\"button\",{className:\"rounded col-span-2 \\r bg-blue-500 hover:bg-blue-600 text-white font-bold\\r p-1              \\r focus:outline-none focus:shadow-outline\",children:\"Review\"})})}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-slate-300 ...\",children:/*#__PURE__*/_jsx(Link,{to:\"/restaurants/\".concat(restaurant.id,\"/update\"),children:/*#__PURE__*/_jsx(\"button\",{className:\"rounded col-span-2 \\r bg-yellow-500 hover:bg-yellow-600 text-white font-bold\\r p-1            \\r focus:outline-none focus:shadow-outline\",children:\"Update\"})})}),/*#__PURE__*/_jsx(\"td\",{className:\"border border-slate-300 ...\",children:/*#__PURE__*/_jsx(\"button\",{className:\"rounded col-span-2 \\r bg-red-500 hover:bg-red-700 text-white font-bold\\r p-1              \\r focus:outline-none focus:shadow-outline\",onClick:function onClick(){return handleDelete(restaurant.id);},children:\"Delete\"})})]},restaurant.id);})})]})});};export default RestaurantList;","map":{"version":3,"names":["React","useEffect","useCallback","Link","axios","useGlobalContext","ReviewRatingStars","RestaurantList","allRestaurants","setAllRestaurants","fetchData","get","response","data","restaurants","console","log","handleDelete","id","delete","renderRating","restaurant","total_ratings","average_rating","map","name","location","repeat","price_range"],"sources":["C:/Users/JoÃ£o Pedro/Dropbox/VisualStudioCode/PortfolioWebsite/projects/PERN-Restaurant-Finder/client/src/components/RestaurantList.jsx"],"sourcesContent":["import React, { useEffect, useCallback } from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport axios from '../apis/axios'\r\nimport { useGlobalContext } from '../globalContext'\r\nimport ReviewRatingStars from './ReviewRatingStars'\r\n\r\nconst RestaurantList = () => {\r\n    const { allRestaurants, setAllRestaurants } = useGlobalContext()\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                const response = await axios.get('/')\r\n                setAllRestaurants(response.data.restaurants)\r\n            } catch (error) {\r\n                console.log(error)\r\n            }\r\n        }\r\n        fetchData()\r\n    }, [allRestaurants])\r\n\r\n    // The data fetching above has an infinite loop.\r\n    // Tried to fix that with useCallback below, but did not work.\r\n    // const fetchData = useCallback(async () => {\r\n    //     console.log(allRestaurants)\r\n    //         try {\r\n    //             const response = await axios.get('/')\r\n    //             setAllRestaurants(response.data.restaurants)\r\n    //         } catch (error) {\r\n    //             console.log(error)\r\n    //         }\r\n    //     }, [allRestaurants])\r\n    //     useEffect(() => {\r\n    //         fetchData()\r\n    //     }, [allRestaurants, fetchData])        \r\n\r\n    const handleDelete = async id => {\r\n        try {\r\n            await axios.delete(`/${id}`)\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    }\r\n\r\n    const renderRating = restaurant => {\r\n        if (!restaurant.total_ratings) {\r\n            return <span>None</span>\r\n        } else {\r\n            return (\r\n                <>\r\n                    <ReviewRatingStars rating={restaurant.average_rating} />\r\n                    <span className='text-yellow-500'>({restaurant.total_ratings})</span>\r\n                </>\r\n            )\r\n        }\r\n    }\r\n\r\n    //rendering component\r\n    return (\r\n        <div className='w-full h-full overflow-y-auto overflow-x-hidden'>\r\n            <table className=\"w-full border-collapse border border-slate-400 text-xs text-center\">\r\n                <thead className='bg-blue-500 text-white break-words sticky top-0'>\r\n                    <tr className='h-8'>\r\n                        <th className=\"border border-slate-300\">Restaurant</th>\r\n                        <th className=\"border border-slate-300\">Location</th>\r\n                        <th className=\"border border-slate-300\">Price Range</th>\r\n                        <th className=\"border border-slate-300\">Ratings</th>\r\n                        <th className=\"border border-slate-300\">Review</th>\r\n                        <th className=\"border border-slate-300\">Edit</th>\r\n                        <th className=\"border border-slate-300\">Delete</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {allRestaurants && allRestaurants.map(restaurant => {\r\n                        return (\r\n                            <tr key={restaurant.id} className='hover:bg-blue-100 h-12'>\r\n                                <td className=\"border border-slate-300 break-all\">{restaurant.name}</td>\r\n                                <td className=\"border border-slate-300 break-all\">{restaurant.location}</td>\r\n                                <td className=\"border border-slate-300 break-all\">{'$'.repeat(restaurant.price_range)}</td>\r\n                                <td className=\"border border-slate-300 break-all\">{renderRating(restaurant)}</td>\r\n                                <td className=\"border border-slate-300\">\r\n                                    <Link to={`/restaurants/${restaurant.id}`}>\r\n                                        <button className=\"rounded col-span-2 \r\n                                                bg-blue-500 hover:bg-blue-600 text-white font-bold\r\n                                                p-1              \r\n                                                focus:outline-none focus:shadow-outline\"\r\n                                        >\r\n                                            Review\r\n                                        </button>\r\n                                    </Link>\r\n                                </td>\r\n                                <td className=\"border border-slate-300 ...\">\r\n                                    <Link to={`/restaurants/${restaurant.id}/update`}>\r\n                                        <button className=\"rounded col-span-2 \r\n                                                bg-yellow-500 hover:bg-yellow-600 text-white font-bold\r\n                                                p-1            \r\n                                                focus:outline-none focus:shadow-outline\">\r\n                                            Update\r\n                                        </button>\r\n                                    </Link>\r\n                                </td>\r\n                                <td className=\"border border-slate-300 ...\">\r\n                                    <button\r\n                                        className=\"rounded col-span-2 \r\n                                                bg-red-500 hover:bg-red-700 text-white font-bold\r\n                                                p-1              \r\n                                                focus:outline-none focus:shadow-outline\"\r\n                                        onClick={() => handleDelete(restaurant.id)}>\r\n                                        Delete\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        )\r\n                    })}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default RestaurantList"],"mappings":"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"},"metadata":{},"sourceType":"module"}